/*
 http://www.gnu.org/licenses/gpl.html GNU General Public License, version 3 or later
*/
var SvpStarter=function(g){function h(a){console.log("SVPS | "+a)}function K(){var a=g("."+e.container);if(m.topic)s.topic=g(".topics .topic",a).not(".template").length;if(m.speaker)s.speaker=g(".speakers .speaker",a).not(".template").length}function B(a){if(L>0)if(typeof SvpPolling!=="undefined"){var b=L*1E3,c=g("#"+e.data).attr("data-hash");if(a)SvpPolling.init(c,M,b);else{t(function(){SvpPolling.init(c,M,b)});w(function(){SvpPolling.stop();l("speaker");l("topic")})}}else h(i.no_svpp,true);else h(i.svpp_off,
false)}function V(a){a=a[a.length-1];try{if(a.valid){var b=Math.round((new Date).getTime()/1E3);if(q.eventBreak)a.end!==null&&a.utcEnd<=b&&W();else if(a.utc<=b)if(a.end===null||a.utcEnd>b)X()}}catch(c){h(i.invalid_eventbreak,true)}}function W(){SvpPolling.stop();var a=g("."+e.container+" .video-player-break"),b='<div id="'+e.player+'" class="video-player"></div>';a.parent().append(b);a.remove();q.eventBreak=false;d.init();C()}function X(){D();f={onTime:[],onSeek:[],onPlay:[],onPause:[]};var a=g("."+
e.container+" #"+e.playerPI).first(),b='<div class="video-player-break"><div class="text"><div class="title">'+i.video_break_title+'</div><div class="sub">'+i.video_break_sub+"</div></div></div>";a.parent().append(b);a.remove();q.eventBreak=true;B(true)}function N(a,b){a=a[a.length-1].id;q[b]!==a&&E(a,b)}function O(a,b){var c=g("."+e.container+" ."+b+"s ."+b).last(),j=c.parent();if(c.hasClass("template")){c.removeClass("template");c.remove();j.removeClass("template")}for(var k=0;k<a.length;k++){var n=
c.clone(),r=a[k];switch(b){case "speaker":g(".speaker-avatar",n).attr("src",Y+r.photo);g(".speaker-data",n).html(r.firstname+" "+r.lastname);break;case "topic":g(".topic-title",n).html(r.title);g(".topic-description",n).html(r.description)}n.attr("data-"+b,r.id).removeClass("active");j.append(n);s[b].length++}}function Z(a){var b={};for(var c in a)if(a.hasOwnProperty(c))b[a[c].streamfileId]=parseInt(c,10);return b}function $(){var a=null;if(m.topic){g("."+e.container+" .topics").on("click",".topic .topic-link",
function(k){k.preventDefault();d.jumpToTopic(g(this).parent(".topic").attr("data-topic"))});var b=g("#"+e.topicTimeline).first();if(b.exists()){try{a=JSON.parse(b.html())}catch(c){h(i.no_json_support,true);return false}a.length>0&&P("topic",a,true);b.html("")}h(i.events_topic_init,false)}if(m.speaker){b=g("#"+e.speakerTimeline).first();if(b.exists()){a=null;try{a=JSON.parse(b.html())}catch(j){h(i.no_json_support,true);return false}a.length>0&&P("speaker",a,false);b.html("")}h(i.events_speaker_init,
false)}}function P(a,b,c){for(var j=0;j<b.length;j++){var k=b[j],n=j+1;k.start=Math.floor(k.relativeTime/1E3);k.end=n<b.length&&k.streamfileId===b[n].streamfileId?Math.floor(b[n].relativeTime/1E3):Number.MAX_SAFE_INTEGER;k.playlist=F(k);if(c)Q[a][k.id]={playlist:k.playlist,time:k.start};x(G.onTime(k,a));u(G.onSeek(k,a))}u(G.onSeekFinal(a))}function R(){d.player.addEventListener("timeupdate",function(){for(var a in f.onTime)f.onTime.hasOwnProperty(a)&&f.onTime[a]({position:this.currentTime})});d.player.addEventListener("seeking",
function(){h("Seeking event fired: time "+this.currentTime);for(var a in f.onSeek)f.onSeek.hasOwnProperty(a)&&f.onSeek[a]({offset:this.currentTime})})}function S(a,b){l("speaker");l("topic");v(a,b);H()}function aa(){l("speaker");l("topic");H()}function y(){d.jw=jwplayer(e.playerObj);d.jw.onReady(function(){l("speaker");l("topic");ba()})}function ba(){var a=null;for(a in f.onTime)f.onTime.hasOwnProperty(a)&&d.jw.onTime(f.onTime[a]);for(a in f.onSeek)f.onSeek.hasOwnProperty(a)&&d.smv.onSeek(f.onSeek[a]);
H()}function H(){var a=null;for(a in f.onPlay)f.onPlay.hasOwnProperty(a)&&d.smv.onPlay(f.onPlay[a]);for(a in f.onPause)f.onPause.hasOwnProperty(a)&&d.smv.onPause(f.onPause[a]);h(i.events_re,false)}function l(a){if(m[a]){var b=g("."+e.container+" ."+a+"s");g("."+a+".active",b).removeClass("active");q[a]=0;b.trigger("SVPS:inactive-"+a)}}function E(a,b){var c=g("."+e.container+" ."+b+"s"),j=g("."+b+"[data-"+b+"="+a+"]",c);g("."+b+".active",c).removeClass("active");q[b]=a;j.first().addClass("active");
c.trigger("SVPS:active-"+b,{id:a,index:j.index()});h(i.activate+" "+b+" "+a,false)}function v(a,b){z.hasOwnProperty(b)||(z[b]={});z[b][a]=true;t(function(){if(z[b][a]){o(a,b);z[b][a]=false}})}function T(){if(typeof jwplayer==="undefined"){h(i.no_jwplayer,true);return false}jwplayer.key="###JWPLAYER_KEY###";return true}function ca(a,b){if(typeof smvplayer!=="undefined"){d.smv=smvplayer(e.player);try{d.smv.init(a,b)}catch(c){h(c,true)}p=function(){return d.smv.getCurrentPlaylistItem().streamfileId};
F=function(j){return j.streamfileId};C=function(){d.smv.whenReady(function(){d.smv.play()})};D=function(){d.smv.stop()};a=d.smv.getEngine();if(a==="hlsjs"||a==="me")da();else if(a==="jw")ea();else a==="html5"&&fa();e.playerPI=e.smvWrapper1+e.player;return true}h(i.no_smvplayer,true);return false}function ea(){d.player=d.smv;e.playerObj=e.smvWrapper1+e.smvWrapper2+e.player;d.jw=jwplayer(e.playerObj);x=function(b){f.onTime.push(b);d.jw.onTime(b)};u=function(b){f.onSeek.push(b);d.smv.onSeek(b)};t=function(b){f.onPlay.push(b);
d.smv.onPlay(b)};w=function(b){f.onPause.push(b);d.smv.onPause(b)};var a={};a.next=d.smv.next;d.smv.next=function(){a.next();y()};a.previous=d.smv.previous;d.smv.previous=function(){a.previous();y()};a.setQualityLevel=d.smv.setQualityLevel;d.smv.setQualityLevel=function(b){a.setQualityLevel(b);y()};a.setAudioLanguage=d.smv.setAudioLanguage;d.smv.setAudioLanguage=function(b){a.setAudioLanguage(b);y()};A=function(b){var c=d.smv.getStatus();if(c!=="PLAYING"&&c!=="IDLE"){v(b.time,b.playlist);d.smv.play()}else o(b.time,
b.playlist)};o=function(b,c){if(c===p())c=null;d.smv.seek(b,c);c!==null&&y()}}function da(){e.playerObj=e.hlsWrapper+e.player;d.player=document.getElementById(e.playerObj);R();x=function(b){f.onTime.push(b)};u=function(b){f.onSeek.push(b)};t=function(b){f.onPlay.push(b);d.smv.onPlay(b)};w=function(b){f.onPause.push(b);d.smv.onPause(b)};var a={};d.smv.onReload(function(){console.log("ONRELOAD TRIGGERED")});a.setQualityLevel=d.smv.setQualityLevel;d.smv.setQualityLevel=function(b){console.log("SETTING QUALITY LEVEL TO "+
b);a.setQualityLevel(b)};d.smv.onComplete(function(){l("speaker");l("topic")});A=function(b){var c=d.smv.getStatus().toUpperCase();if(c!=="PLAYING"&&c!=="IDLE"){v(b.time,b.playlist);d.smv.play()}else o(b.time,b.playlist)};o=function(b,c){if(c===p())c=null;d.smv.seek(b,c);c!==null&&aa(b,c)}}function fa(){e.playerObj=e.player+e.html5Wrapper;d.player=document.getElementById(e.playerObj);R();x=function(b){f.onTime.push(b)};u=function(b){f.onSeek.push(b)};t=function(b){f.onPlay.push(b);d.smv.onPlay(b)};
w=function(b){f.onPause.push(b);d.smv.onPause(b)};var a={};a.setQualityLevel=d.smv.setQualityLevel;d.smv.setQualityLevel=function(b){var c=d.player.currentTime,j=p();a.setQualityLevel(b);S(c,j)};a.setAudioLanguage=d.smv.setAudioLanguage;d.smv.setAudioLanguage=function(b){var c=d.player.currentTime,j=p();a.setAudioLanguage(b);S(c,j)};d.smv.onComplete(function(){l("speaker");l("topic")});A=function(b){var c=b.playlist===p()?null:b.playlist;if(d.smv.getStatus()==="PLAYING")o(b.time,c);else if(c===null){v(b.time,
null);d.smv.play()}else h(i.no_playlist_seek,true)};o=function(b,c){d.smv.seek(b,c)}}function U(a){jwplayer(e.player).setup(a);d.jw=jwplayer(e.player);d.player=d.jw;x=function(c){d.jw.onTime(c)};u=function(c){d.jw.onSeek(c)};t=function(c){d.jw.onPlay(c)};w=function(c){d.jw.onPause(c)};p=function(){return d.jw.getPlaylistIndex()};C=function(){d.jw.onReady(function(){d.jw.play()})};D=function(){d.jw.stop()};d.jw.onPlaylistItem(function(){l("speaker");l("topic")});A=function(c){if(d.jw.getState().toUpperCase()!==
"PLAYING"){v(c.time,c.playlist);d.jw.play()}else o(c.time,c.playlist)};if(a.hasOwnProperty("playlist")){var b=Z(a.playlist);F=function(c){return b[c.streamfileId]}}else{h(i.no_playlist,true);m.topic=false;m.speaker=false}}function ga(a){if(T(true)){U(a);o=function(b,c){if(p()!==c){d.jw.once("playlistItem",function(){d.jw.once("play",function(){d.jw.seek(b)})});d.jw.playlistItem(c)}else d.jw.seek(b)};v=function(b,c){d.jw.once("play",function(){o(b,c)})};return true}return false}function ha(a){if(T(false)){U(a);
o=function(b,c){if(p()!==c){I[c]=true;d.jw.onPlaylistItem(function(){if(I[c]){d.jw.seek(b);I[c]=false}});d.jw.playlistItem(c)}else d.jw.seek(b)};return true}return false}var Y="###SPEAKER_IMAGE_DIR###",L=parseInt("###POLLING_INTERVAL###",10),M=parseInt("###CURRENT_PAGE_ID###",10),ia=parseInt("###PLAYER_TYPE###",10),m={breaks:parseInt("###MEETINGDATA_BREAKS###",10),topic:parseInt("###MEETINGDATA_TOPICS###",10),speaker:parseInt("###MEETINGDATA_SPEAKERS###",10)},Q={topic:{}},s={topic:0,speaker:0},q=
{topic:0,speaker:0,eventBreak:false},f={onTime:[],onSeek:[],onPlay:[],onPause:[]},z={},I={},J={topic:false,speaker:false},G={onTime:function(a,b){return function(c){c.position>=a.start&&c.position<a.start+0.4&&a.id!==q[b]&&a.playlist===p()&&E(a.id,b)}},onSeek:function(a,b){return function(c){if(c.offset>=a.start&&c.offset<a.end&&a.playlist===p()){a.id!==q[b]&&E(a.id,b);J[b]=true}}},onSeekFinal:function(a){return function(){!J[a]&&q[a]!==0&&l(a);J[a]=false}}},e={player:"tx-streamovations-vp-play",
playerObj:"tx-streamovations-vp-play",playerPI:"tx-streamovations-vp-play",playerContainer:"video-player-container",smvWrapper1:"smvplayer_",smvWrapper2:"engineWrapper_",hlsWrapper:"smv_html5videotag_",html5Wrapper:"_html5videotag",data:"tx-streamovations-vp-playerdata",config:"tx-streamovations-vp-playerconfig",topicTimeline:"tx-streamovations-vp-topictimeline",speakerTimeline:"tx-streamovations-vp-speakertimeline",container:"tx-streamovations-vp"},i={no_svpp:"SVPP not loaded, polling inactive",
svpp_off:"Polling disabled",no_player_data:"The player element or player data is not available",no_playlist:"Missing essential playlist data",no_json_support:"No JSON.parse support in user agent",player_data_invalid:"Player data is invalid or in an unsupported format",invalid_player:"No supported player configured",invalid_eventbreak:"Eventbreak data is invalid or in an unsupported format",no_jwplayer:"No jwplayer loaded",no_jwplayer_key:"A jwplayer license key is required",no_smvplayer:"No smvplayer loaded",
events_topic_init:"initializing topic event handlers",events_speaker_init:"initializing speaker event handlers",events_re:"Reattached event callbacks",no_timestamp:"Topic has no registered timestamps",no_playlist_seek:"Can only seek to other playlist item during playback",activate:"Activated",video_break_title:"###VIDEO_BREAK_TITLE###",video_break_sub:"###VIDEO_BREAK_SUB###"};g.fn.exists=function(){return this.length!==0};var u=null,x=null,t=null,w=null,p=null,F=null,A=null,o=null,D=null,C=null,d=
{player:null,jw:null,smv:null,isLiveStream:false,init:function(){var a=g("."+e.playerContainer),b=g("#"+e.data).first();if(!a.exists()||!b.exists()){h(i.no_player_data,true);return false}var c=null,j=null;try{c=JSON.parse(b.html().trim())}catch(k){h(i.no_json_support,true);return false}if(typeof c!=="object"){h(i.player_data_invalid,true);return false}if(c.hasOwnProperty("application"))this.isLiveStream=c.application==="rtplive";if(g("#"+e.player,a).exists())try{switch(ia){case 3:var n=g("#"+e.config).first();
if(n.exists())j=JSON.parse(n.html().trim());if(!ca(c,j))return false;break;case 2:if(!ga(c))return false;break;case 1:if(!ha(c))return false;break;default:h(i.invalid_player,true);return false}t(function(){a.trigger("SVPS:play")});if(this.isLiveStream){if(m.topic||m.speaker||m.breaks){K();B(false)}}else $()}catch(r){h(r,true)}else if(this.isLiveStream&&m.breaks){q.eventBreak=true;K();B(true)}return true},processMeetingdataChange:function(a){if(m.topic){a.hasOwnProperty("topics")&&a.topics!==false&&
a.topics.length>s.topic&&O(a.topics.slice(s.topic),"topic");a.hasOwnProperty("topicTimeline")&&a.topicTimeline!==false&&a.topicTimeline.length>0&&N(a.topicTimeline,"topic")}if(m.speaker){a.hasOwnProperty("speakers")&&a.speakers!==false&&a.speakers.length>s.speaker&&O(a.speakers.slice(s.speaker),"speaker");a.hasOwnProperty("speakerTimeline")&&a.speakerTimeline!==false&&a.speakerTimeline.length>0&&N(a.speakerTimeline,"speaker")}m.breaks&&a.hasOwnProperty("eventBreaks")&&a.eventBreaks!==false&&a.eventBreaks.length>
0&&V(a.eventBreaks)},jumpToTopic:function(a){a=Q.topic[a];a!==undefined?A(a):h(i.no_timestamp,true)}};return d}(jQuery);